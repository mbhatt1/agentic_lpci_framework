<div align="center">
<br/>
<p align="center">
  <img src="https://github.com/user-attachments/assets/lpci-logo-dark.png#gh-dark-mode-only" alt="LPCI Framework Logo" width="200">
  <img src="https://github.com/user-attachments/assets/lpci-logo-light.png#gh-light-mode-only" alt="LPCI Framework Logo" width="200">
</p>

# ğŸ›¡ï¸ **LPCI Security Testing Framework** ğŸ›¡ï¸

### âš¡ Next-Generation AI Vulnerability Testing Suite âš¡

<p align="center">
  <img src="https://img.shields.io/badge/Version-1.0.0-blue?style=for-the-badge&logo=github" alt="Version">
  <img src="https://img.shields.io/badge/Python-3.8+-green?style=for-the-badge&logo=python&logoColor=white" alt="Python">
  <img src="https://img.shields.io/badge/License-MIT-yellow?style=for-the-badge&logo=opensourceinitiative&logoColor=white" alt="License">
  <img src="https://img.shields.io/badge/Status-Active-success?style=for-the-badge&logo=statuspage&logoColor=white" alt="Status">
</p>

<p align="center">
  <img src="https://img.shields.io/github/stars/your-org/lpci-framework?style=for-the-badge&logo=github" alt="Stars">
  <img src="https://img.shields.io/github/forks/your-org/lpci-framework?style=for-the-badge&logo=github" alt="Forks">
  <img src="https://img.shields.io/github/issues/your-org/lpci-framework?style=for-the-badge&logo=github" alt="Issues">
  <img src="https://img.shields.io/github/contributors/your-org/lpci-framework?style=for-the-badge&logo=github" alt="Contributors">
</p>

<h3 align="center">
  <em>Exposing Critical Vulnerabilities in AI Systems Through Advanced Logic-layer Prompt Control Injection</em>
</h3>

<p align="center">
  <a href="#-quick-start">Quick Start</a> â€¢
  <a href="#-key-features">Features</a> â€¢
  <a href="#-attack-vectors">Attack Vectors</a> â€¢
  <a href="#-results">Results</a> â€¢
  <a href="#-documentation">Docs</a> â€¢
  <a href="#-contributing">Contribute</a>
</p>

---

<img src="https://user-images.githubusercontent.com/74038190/212284100-561aa473-3905-4a80-b561-0d28506553ee.gif" width="100%">

</div>

## ğŸŒŸ **What is LPCI?**

**LPCI (Latent Prompt Control Injection)** represents a paradigm shift in AI security vulnerabilities. Unlike traditional prompt injections that affect single interactions, LPCI attacks:

<table>
<tr>
<td width="50%">

### ğŸ¯ **Traditional Prompt Injection**
- ğŸ”´ Single-shot attacks
- ğŸ”´ Current conversation only
- ğŸ”´ Surface-level manipulation
- ğŸ”´ Immediate execution
- ğŸ”´ Easy to detect
- ğŸ”´ Limited scope

</td>
<td width="50%">

### ğŸš€ **LPCI Attacks**
- âœ… Persistent, multi-stage attacks
- âœ… Cross-session & cross-user impact
- âœ… Infrastructure-level exploitation
- âœ… Delayed/conditional activation
- âœ… Hidden through semantic camouflage
- âœ… System-wide compromise

</td>
</tr>
</table>

---

## ğŸ¯ **Key Features**

<div align="center">

```mermaid
%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#1f2937',
    'primaryTextColor': '#fff',
    'primaryBorderColor': '#60a5fa',
    'lineColor': '#60a5fa',
    'secondaryColor': '#374151',
    'tertiaryColor': '#4b5563',
    'background': '#111827',
    'mainBkg': '#1f2937',
    'secondBkg': '#374151',
    'tertiaryBkg': '#4b5563',
    'clusterBkg': '#1f2937',
    'clusterBorder': '#60a5fa',
    'labelBackground': '#1f2937',
    'edgeColor': '#60a5fa'
  }
}}%%
graph TD
    A[ğŸ›¡ï¸ LPCI Framework] --> B[ğŸ¯ Attack Vectors]
    A --> C[ğŸ¤– AI Models]
    A --> D[ğŸ—ï¸ Infrastructure]
    A --> E[ğŸ“Š Analytics]
    
    B --> B1[ğŸ—„ï¸ Vector Store Poisoning]
    B --> B2[ğŸ”€ Session Hijacking]
    B --> B3[ğŸ› ï¸ Tool Poisoning]
    B --> B4[ğŸ“š RAG Exploitation]
    
    C --> C1[ğŸŸ¢ OpenAI GPT-4 Family]
    C --> C2[ğŸ”µ Anthropic Claude]
    C --> C3[ğŸŸ¡ Google Gemini]
    
    D --> D1[ğŸ”´ Redis Sessions]
    D --> D2[ğŸ“¦ Vector Database]
    D --> D3[âš™ï¸ MCP Server]
    D --> D4[ğŸ”— RAG Pipeline]
    
    E --> E1[ğŸ“ˆ Real-time Analysis]
    E --> E2[ğŸ¨ Visualizations]
    E --> E3[ğŸ“‘ Reports]
    
    style A fill:#1e40af,stroke:#60a5fa,stroke-width:3px,color:#fff
    style B fill:#dc2626,stroke:#f87171,stroke-width:2px,color:#fff
    style C fill:#059669,stroke:#34d399,stroke-width:2px,color:#fff
    style D fill:#7c3aed,stroke:#a78bfa,stroke-width:2px,color:#fff
    style E fill:#ea580c,stroke:#fb923c,stroke-width:2px,color:#fff
```

</div>

### ğŸš€ **Core Capabilities**

<div align="center">

| Feature | Description | Status |
|:--------|:------------|:------:|
| ğŸ§  **Memory-Aware Agents** | Persistent context across sessions | âœ… |
| ğŸ”Œ **Real API Integration** | No simulations - actual API calls | âœ… |
| ğŸ¯ **4 Attack Vectors** | Comprehensive vulnerability coverage | âœ… |
| ğŸ“Š **Advanced Analytics** | Statistical analysis & trends | âœ… |
| ğŸ¨ **Beautiful Reports** | Automated visualization generation | âœ… |
| ğŸ” **Audit Trail** | Complete security event logging | âœ… |
| âš™ï¸ **Flexible Config** | Customizable test scenarios | âœ… |

</div>

---

## ğŸš€ **Quick Start**

### ğŸ“‹ **Prerequisites**

<div align="center">

| Requirement | Minimum Version | Recommended |
|:------------|:----------------|:------------|
| ğŸ **Python** | 3.8+ | 3.10+ |
| ğŸ’¾ **RAM** | 4GB | 8GB+ |
| ğŸ’» **OS** | Win/Mac/Linux | Ubuntu 22.04 |

</div>

### ğŸ”§ **Installation**

<div align="center">

```bash
# ğŸ“¥ Clone the repository
git clone https://github.com/your-org/lpci-framework
cd lpci-framework

# ğŸ”¨ Install dependencies
pip install -r requirements.txt

# ğŸ”‘ Configure API keys
cp .env.example .env
# Edit .env with your API keys
```

</div>

### âš¡ **Run Your First Test**

<div align="center">

```bash
# ğŸ¯ Test all models with all attack vectors
python agentic_lpci_framework/lpci_test_cli.py \
  --models gpt-4 gpt-4o claude-3 \
  --output-dir ./results

# ğŸ“Š Results will be in:
# ./results/lpci_test_results_*.json
# ./results/lpci_test_report_*.md
# ./results/LPCI_ANALYSIS_REPORT.md
```

</div>

---

## ğŸ¯ **Attack Vectors**

<div align="center">

### ğŸ›¡ï¸ **Four Devastating Attack Patterns** ğŸ›¡ï¸

</div>

### 1ï¸âƒ£ **Vector Store Poisoning** ğŸ—„ï¸

<div align="center">

```mermaid
%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#1f2937',
    'primaryTextColor': '#fff',
    'primaryBorderColor': '#ef4444',
    'lineColor': '#60a5fa',
    'background': '#111827',
    'mainBkg': '#1f2937',
    'actorBkg': '#374151',
    'actorBorder': '#60a5fa',
    'actorTextColor': '#fff',
    'signalColor': '#60a5fa',
    'signalTextColor': '#fff'
  }
}}%%
sequenceDiagram
    participant A as ğŸ¦¹ Attacker
    participant V as ğŸ“¦ Vector DB
    participant T as â° Time
    participant U as ğŸ‘¤ User
    participant AI as ğŸ¤– AI Model
    
    rect rgb(31, 41, 55)
        Note over A,V: ğŸ’‰ INJECTION PHASE
        A->>V: Plant poisoned documents
        V-->>A: Stored with embeddings
    end
    
    rect rgb(55, 65, 81)
        Note over V,T: â³ DORMANT PHASE
        T->>T: Days/Weeks pass...
        Note over V: Payload remains hidden
    end
    
    rect rgb(127, 29, 29)
        Note over U,AI: ğŸ’¥ ACTIVATION PHASE
        U->>AI: "Show invoice process"
        AI->>V: Semantic search
        V-->>AI: Returns poisoned doc
        AI->>U: Executes malicious code
        Note over U: ğŸš¨ COMPROMISED!
    end
```

**Success Rate: ğŸ”´ 95% | Severity: CRITICAL**

</div>

### 2ï¸âƒ£ **Cross-Session Hijacking** ğŸ”€

<div align="center">

```mermaid
%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#1f2937',
    'lineColor': '#60a5fa',
    'arrowheadColor': '#60a5fa',
    'fontFamily': 'Arial',
    'fontSize': '16px',
    'darkMode': true
  }
}}%%
graph LR
    subgraph " "
        A[ğŸ‘¤ Alice<br/>Attacker] -->|"ğŸ’£ Plants Bomb"| R[(ğŸ”´ Redis<br/>Session Store)]
        R -->|"â° Waits for trigger"| B[ğŸ‘¤ Bob<br/>Victim]
        B -->|"ğŸ“ 'quarterly review'"| AI[ğŸ¤– AI System]
        AI -->|"ğŸ’¥ Detonates"| COMP[ğŸš¨ Session<br/>Hijacked]
    end
    
    style A fill:#991b1b,stroke:#ef4444,stroke-width:2px,color:#fff
    style R fill:#7f1d1d,stroke:#ef4444,stroke-width:2px,color:#fff
    style B fill:#1e3a8a,stroke:#3b82f6,stroke-width:2px,color:#fff
    style COMP fill:#991b1b,stroke:#ef4444,stroke-width:3px,color:#fff
```

**Success Rate: ğŸŸ  65% | Severity: HIGH**

</div>

### 3ï¸âƒ£ **Tool Poisoning** ğŸ› ï¸

<div align="center">

```mermaid
%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#1f2937',
    'primaryTextColor': '#fff',
    'primaryBorderColor': '#60a5fa',
    'lineColor': '#60a5fa',
    'background': '#111827'
  }
}}%%
stateDiagram-v2
    [*] --> Discovery: ğŸ¤– AI discovers tools
    Discovery --> Clean: âœ… Original tools
    Clean --> Poisoned: ğŸ¦¹ Attacker replaces
    Poisoned --> Called: ğŸ“ AI calls tool
    Called --> Backdoor: ğŸšª Hidden code executes
    Backdoor --> Compromised: ğŸ’€ System owned
    Compromised --> [*]
    
    note right of Poisoned
        Looks legitimate but
        contains backdoor code:
        - delete_all_files()
        - bypass_auth()
        - grant_admin()
    end note
```

**Success Rate: ğŸ”´ 85% | Severity: CRITICAL**

</div>

### 4ï¸âƒ£ **RAG Pipeline Exploitation** ğŸ“š

<div align="center">

```mermaid
%%{init: {
  'theme': 'base',
  'themeVariables': {
    'pie1': '#dc2626',
    'pie2': '#059669', 
    'pie3': '#dc2626',
    'pie4': '#059669',
    'pie5': '#dc2626',
    'pieOuterLabelColor': '#fff',
    'pieLegendTextColor': '#fff',
    'pieSectionTextColor': '#fff',
    'pieStrokeColor': '#374151',
    'pieStrokeWidth': '2px'
  }
}}%%
pie title "Knowledge Base Contamination"
    "ğŸ”´ Poisoned Documents" : 25
    "âœ… Clean Documents" : 75
```

**Even 25% contamination leads to 75% attack success!**

</div>

---

## ğŸ“Š **Latest Test Results**

<div align="center">

### ğŸ¯ **Model Vulnerability Scores**

| Model | Overall Risk | Success Rate | Classification |
|:------|:-------------|:-------------|:---------------|
| ğŸ¤– **GPT-4** | 9.4/10 | 93.75% | ğŸ”´ CRITICAL |
| ğŸŸ¢ **GPT-4o** | 8.8/10 | 87.50% | ğŸ”´ CRITICAL |
| ğŸ”· **GPT-4.1-mini** | 7.9/10 | 78.75% | ğŸŸ  HIGH |
| ğŸŸ¡ **GPT-4o-mini** | 6.9/10 | 68.75% | ğŸŸ  HIGH |
| ğŸ”¶ **GPT-4.1-nano** | 5.6/10 | 56.25% | ğŸŸ¡ MEDIUM |

</div>

<div align="center">

```mermaid
%%{init: {
  'theme': 'base',
  'themeVariables': {
    'xyChart': {
      'backgroundColor': 'transparent',
      'titleColor': '#fff',
      'xAxisLabelColor': '#fff',
      'yAxisLabelColor': '#fff',
      'plotColorPalette': '#dc2626,#f59e0b,#eab308,#f59e0b,#84cc16'
    }
  }
}}%%
xychart-beta
    title "Attack Success Rates by Model"
    x-axis [GPT-4, GPT-4o, GPT-4.1-mini, GPT-4o-mini, GPT-4.1-nano]
    y-axis "Success Rate (%)" 0 --> 100
    bar [93.75, 87.50, 78.75, 68.75, 56.25]
```

</div>

---

## ğŸ“– **Documentation**

<div align="center">

| Document | Description | Link |
|:---------|:------------|:-----|
| ğŸ—ï¸ **Architecture** | System design & components | [View â†’](./docs/architecture.md) |
| ğŸ”„ **System Flows** | Complete attack flow diagrams | [View â†’](./agentic_lpci_framework/SYSTEM_FLOWS.md) |
| ğŸ¯ **Attack Details** | Technical deep dive | [View â†’](./agentic_lpci_framework/LPCI_ATTACK_EXPLAINED.md) |
| ğŸ“Š **Test Results** | Latest analysis report | [View â†’](./lpci_output/LPCI_ANALYSIS_REPORT.md) |
| ğŸ”§ **API Reference** | Code documentation | [View â†’](./docs/api.md) |

</div>

---

## ğŸ¤ **Contributing**

<div align="center">

### ğŸ’¡ **Join Our Security Research Community** ğŸ’¡

We welcome contributions from security researchers, developers, and AI enthusiasts!

<img src="https://contrib.rocks/image?repo=your-org/lpci-framework" />

</div>

<details>
<summary><b>ğŸ“‹ Contribution Guidelines</b></summary>

1. ğŸ´ **Fork** the repository
2. ğŸŒ¿ **Create** a feature branch (`git checkout -b feature/amazing-feature`)
3. ğŸ’» **Commit** your changes (`git commit -m 'Add amazing feature'`)
4. ğŸ“¤ **Push** to the branch (`git push origin feature/amazing-feature`)
5. ğŸ”„ **Open** a Pull Request

### ğŸ“ Code Standards
- Follow PEP 8 for Python code
- Add comprehensive docstrings
- Include unit tests for new features
- Update documentation as needed

</details>

---

## ğŸ”’ **Security & Ethics**

<div align="center">

### âš ï¸ **Responsible Disclosure Policy** âš ï¸

This framework is designed for **legitimate security research only**.

| âœ… **Permitted Use** | âŒ **Prohibited Use** |
|:---------------------|:----------------------|
| Security testing with permission | Unauthorized system access |
| Academic research | Malicious attacks |
| Improving AI safety | Data theft or destruction |
| Vulnerability assessment | Production system compromise |

</div>

---

## ğŸ“ˆ **Project Stats**

<div align="center">

<img src="https://github-readme-stats.vercel.app/api?username=your-org&repo=lpci-framework&show_icons=true&theme=dark" />

### ğŸŒŸ **Star History**

<img src="https://api.star-history.com/svg?repos=your-org/lpci-framework&type=Date&theme=dark" />

</div>

---

## ğŸ“¬ **Get in Touch**

<div align="center">

### ğŸ’¬ **Connect With Us**

<p>
  <a href="https://twitter.com/lpci_framework">
    <img src="https://img.shields.io/badge/Twitter-1DA1F2?style=for-the-badge&logo=twitter&logoColor=white" />
  </a>
  <a href="https://discord.gg/lpci">
    <img src="https://img.shields.io/badge/Discord-7289DA?style=for-the-badge&logo=discord&logoColor=white" />
  </a>
  <a href="mailto:security@lpci-framework.ai">
    <img src="https://img.shields.io/badge/Email-D14836?style=for-the-badge&logo=gmail&logoColor=white" />
  </a>
  <a href="https://lpci-framework.ai">
    <img src="https://img.shields.io/badge/Website-4285F4?style=for-the-badge&logo=google-chrome&logoColor=white" />
  </a>
</p>

</div>

---

## âš–ï¸ **License**

<div align="center">

This project is licensed under the **MIT License** - see the [LICENSE](LICENSE) file for details.

<br/>

### ğŸ·ï¸ **Topics**

`ai-security` `prompt-injection` `lpci` `vulnerability-research` `llm-security` `red-team` `penetration-testing` `security-framework` `ai-safety` `cross-session-attacks`

<br/>

---

<p align="center">
  <img src="https://img.shields.io/badge/Made%20with-â¤ï¸-red?style=for-the-badge" alt="Made with Love">
  <img src="https://img.shields.io/badge/Built%20for-Security%20Researchers-blue?style=for-the-badge" alt="Built for Security">
  <img src="https://img.shields.io/badge/Powered%20by-AI-green?style=for-the-badge" alt="Powered by AI">
</p>

<h6 align="center">
  Copyright Â© 2025 LPCI Framework Team. All rights reserved.
</h6>

</div>